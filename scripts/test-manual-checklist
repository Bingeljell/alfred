#!/usr/bin/env bash
set -euo pipefail
cat <<'CHECKLIST'
Web Console Manual Checklist
1. Copy `.env.example` to `.env` and set required values.
2. Start gateway: npm run dev:gateway
3. Open http://localhost:3000/ui
4. Send a chat message from the UI and confirm immediate response in the log panel.
5. Send as async job and confirm jobId appears and can be checked with Job Controls.
6. Run Memory Search/Sync/Status actions and confirm responses are shown in the log panel.

OAuth Manual Checklist
1. In `/ui`, click OAuth Connect and approve on the mock authorize page.
2. Back in `/ui`, click OAuth Status and confirm connected mode/status is returned.
3. Send `/auth status` through chat endpoint and confirm connected response.
4. Send `/auth disconnect` and verify `/auth status` reports not connected.
5. (Optional live mode) set `OAUTH_OPENAI_MODE=live` and provider env vars, then repeat start/callback/status flow.

Phase 1 Manual Checklist
1. Start gateway: npm run dev:gateway
2. Start worker: npm run dev:worker
3. Submit a job:
   curl -s -X POST http://localhost:3000/v1/jobs \
     -H 'content-type: application/json' \
     -d '{"type":"stub_task","payload":{"action":"manual-check"},"priority":5}'
4. Fetch job until status is succeeded:
   curl -s http://localhost:3000/v1/jobs/<jobId>
5. Verify result.summary contains processed:manual-check

Phase 2 Manual Checklist
1. Post Baileys-style inbound async job:
   curl -s -X POST http://localhost:3000/v1/whatsapp/baileys/inbound \
     -H 'content-type: application/json' \
     -d '{"key":{"id":"manual-1","remoteJid":"owner@s.whatsapp.net"},"message":{"conversation":"/job run phase2"}}'
2. Send normal chat while job is running:
   curl -s -X POST http://localhost:3000/v1/messages/inbound \
     -H 'content-type: application/json' \
     -d '{"sessionId":"owner@s.whatsapp.net","text":"are you still there?","requestJob":false}'
3. Verify chat response is immediate and job state eventually succeeds.

Phase 3 Manual Checklist
1. Add a memory note:
   curl -s -X POST http://localhost:3000/v1/memory/notes \
     -H 'content-type: application/json' \
     -d '{"text":"We chose Baileys and TypeScript for v1."}'
2. Sync memory:
   curl -s -X POST http://localhost:3000/v1/memory/sync
3. Search memory:
   curl -s "http://localhost:3000/v1/memory/search?q=what+did+we+choose+for+v1"
4. Confirm results include source citations (`path:start:end`).

Phase 4 Manual Checklist
1. Prepare a local/allowlisted skill repo with `skill.json` and runnable entrypoint.
2. Install skill using `SkillInstaller` (dev script/REPL path) pinned to commit SHA.
3. Run skill using `SkillRunner` with input payload and workspace dir.
4. Verify success output contract (`output.json`) and structured failure contract (`error.json`).
5. Confirm non-allowlisted repos and wildcard network manifests are blocked.

Phase 5 Manual Checklist
1. Add task:
   curl -s -X POST http://localhost:3000/v1/messages/inbound \
     -H 'content-type: application/json' \
     -d '{"sessionId":"owner@s.whatsapp.net","text":"/task add call accountant","requestJob":false}'
2. List tasks:
   curl -s -X POST http://localhost:3000/v1/messages/inbound \
     -H 'content-type: application/json' \
     -d '{"sessionId":"owner@s.whatsapp.net","text":"/task list","requestJob":false}'
3. Create reminder:
   curl -s -X POST http://localhost:3000/v1/messages/inbound \
     -H 'content-type: application/json' \
     -d '{"sessionId":"owner@s.whatsapp.net","text":"/remind 2026-02-23T09:00:00Z standup","requestJob":false}'
4. Add and list notes:
   - send `/note add Bring medical records`
   - send `/note list` and verify note appears
5. Confirm approval gate:
   send `send <text>` then `approve <token>` and verify approved execution response.
6. Fail and retry a job:
   - submit failing job fixture
   - run `/job retry <jobId>`
   - confirm new job is queued and completes.
CHECKLIST
