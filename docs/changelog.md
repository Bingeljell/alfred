# Changelog

- **2026-03-01** > apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/gateway_service_llm.test.ts > `handlePlannerPrimaryRoutes` local-ops precedence > Fixed planner primary-route behavior so operational requests (for example starting local services) are evaluated through natural-language local-ops routing before worker research delegation, preventing `command + needsWorker` plans from being incorrectly queued as `agentic_turn` web-search jobs.
- **2026-03-01** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/routes/observability_routes.ts, apps/gateway-orchestrator/src/app.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/gateway_app_ui_route.test.ts > `previewExecutionPolicy`, `/v1/debug/execution-policy`, planner trace delegation metadata > Added a debug execution-policy preview endpoint plus a gateway preview method to show predicted route/delegation decisions for a message, and enriched planner-trace metadata with `plannerWillDelegateWorker`, `plannerForcedWorkerDelegation`, and `plannerDelegationReason` so routing can be inspected in stream logs.
- **2026-03-01** > apps/gateway-orchestrator/src/builtins/intent_planner.ts, apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/intent_planner.test.ts, tests/unit/gateway_service_llm.test.ts > `enforceExecutionPolicy`, `shouldForceWorkerDelegation`, planner/route delegation policy > Added a centralized execution policy so worker delegation is enforced for worker-required intents and side-effect attachment flows even when planner output is inconsistent (`needsWorker=false`), avoiding per-feature one-off routing fixes as capabilities expand.
- **2026-03-01** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/command_parser.test.ts > `handlePlannerPrimaryRoutes`, `latestJobStatusMessage`, approval token parsing > Fixed planner routing so `web_research` intents always delegate to worker even when planner misflags `needsWorker=false`, made status-query intent return deterministic job-status responses without falling into chat-turn, and tightened `approve/reject` token parsing so natural-language phrases like `approve search` are no longer treated as invalid token commands.
- **2026-03-01** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/llm/hybrid_llm_service.ts, apps/gateway-orchestrator/src/llm/codex_chat_service.ts, apps/gateway-orchestrator/src/llm/openai_responses_service.ts, apps/gateway-orchestrator/src/orchestrator/types.ts, apps/gateway-orchestrator/src/app_types.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/orchestrator_phases.test.ts > `executeChatTurn`, `prepareChatInput`, `routeNaturalLanguageLocalOpsRequest`, `proposeLocalOps`, `tryParseJsonObject`, `LlmExecutionMode` > Made `run_chat_turn` explicitly reasoning-only by passing execution mode through the LLM stack, added natural-language local-ops routing that turns operational requests into approval-gated `shell_exec` actions, and enforced shell-cwd allowlist checks with clearer approval payload previews.
- **2026-03-01** > apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts, .env.example, apps/gateway-orchestrator/src/builtins/command_parser.ts, tests/unit/config.test.ts, tests/unit/command_parser.test.ts, tests/unit/worker_progress.test.ts > `loadConfig`, gateway capability-policy wiring, `parseCommand` (`/shell --cwd`, `/exec --cwd`) > Added `ALFRED_SHELL_ALLOWED_DIRS` configuration and server wiring, introduced `--cwd` support for shell commands, expanded parser/config coverage, and stabilized worker progress-event test timing.
- **2026-02-28** > docs/architecture_principles.md, docs/agentic_vision.md, docs/detailed_project_plan.md, docs/features.md, docs/adr/0001-gateway-control-plane-and-agentic-runtime.md, docs/progress.md > architecture principle lock + cross-doc linking > Consolidated language-agnostic architecture principles (minimal core, gateway control plane, provider-agnostic runtime, typed safety-tier tools, hybrid execution, worker execution plane, local-first memory, policy-first security, observability-first, progressive delivery) and linked them across vision/plan/features/ADR so this direction is preserved in canonical docs.
- **2026-02-28** > apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/gateway_service_llm.test.ts, docs/progress.md > `handlePlannerPrimaryRoutes` worker delegation condition > Fixed planner routing so any non-status plan with `needsWorker=true` delegates to worker/run-spec execution even when planner labels intent as `command`; this prevents attachment/retry requests from falling through to chat-only responses.
- **2026-02-28** > docs/terminal_file_explorer_recommendations.md, docs/progress.md > terminal file tree recommendation brief > Added a macOS-focused recommendation note confirming iTerm2 lacks a built-in file-tree explorer, with alternatives (Warp, Wave Terminal, Electerm) and in-terminal file-manager options (Yazi, Ranger).
- **2026-02-27** > apps/worker/src/execution/processor.ts, apps/worker/src/execution/status_handler.ts, apps/worker/src/worker.ts, apps/gateway-orchestrator/src/local_queue_store.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/builtins/memory_compaction_service.ts, .env.example, tests/unit/worker_execution_modules.test.ts, tests/unit/worker_progress.test.ts, tests/unit/worker_status_handler.test.ts, tests/unit/local_queue_store.test.ts, tests/unit/config.test.ts, tests/unit/heartbeat_service.test.ts, docs/progress.md > `agentic_turn` budgeted loop, ranking repair + heuristic fallback, concise synthesis fallback, approval yes/no wording, worker retry/watchdog recovery, memory compaction default interval > Reworked agentic worker turns to use budget-aware retrieval/ranking/synthesis with ranking-repair and heuristic fallback paths, tightened recommendation quality checks to avoid link-as-answer behavior, reduced noisy progress spam while preserving directional updates, updated approval prompts to prioritize yes/no while keeping explicit token resolution, added automatic retry handling for retryable worker failures and stale-job watchdog recovery, and switched memory compaction default cadence to daily with config/env/test updates.
- **2026-02-27** > apps/gateway-orchestrator/src/orchestrator/channel_submission.ts, apps/gateway-orchestrator/src/routes/channel_routes.ts, apps/gateway-orchestrator/src/whatsapp/normalize_baileys.ts, apps/gateway-orchestrator/src/orchestrator/normalize_phase.ts, tests/unit/channel_submission.test.ts, tests/unit/orchestrator_phases.test.ts, docs/progress.md > `normalizeInboundFromChannel`, `withChannelOrigin`, `/v1/messages/inbound` submission normalization, Baileys origin propagation > Unified ingress contract so channel submissions are normalized with explicit origin metadata before reaching gateway orchestration, ensuring web and WhatsApp lanes share the same control-plane turn context shape.
- **2026-02-27** > apps/gateway-orchestrator/src/orchestrator/sandbox_policy.ts, apps/gateway-orchestrator/src/orchestrator/tool_policy_engine.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/app_types.ts, .env.example, tests/unit/sandbox_policy.test.ts, tests/unit/tool_policy_engine.test.ts, tests/unit/config.test.ts, tests/unit/orchestrator_phases.test.ts, docs/progress.md > `isSandboxTargetEnabled`, `evaluateShellCommandPolicy`, `ToolPolicyInput.wasmEnabled`, gateway sandbox wiring > Unified shell and wasm controls behind one sandbox policy surface, added explicit `ALFRED_WASM_ENABLED` config plumbing, and rewired gateway/tool-policy evaluation to consume shared sandbox enablement semantics with test coverage.
- **2026-02-27** > apps/gateway-orchestrator/src/orchestrator/turn_phase_handlers.ts, apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/turn_phase_handlers.test.ts, docs/progress.md > `runDirectivesPhase`, `runPlanPhase`, `runPolicyPhase`, `runRoutePhase`, `runPersistPhase`, `runDispatchPhase`, `GatewayService.handleInbound` phase wiring > Added explicit turn-phase handler modules and rewired gateway inbound orchestration/helper routes to use those handlers so phase transitions are standardized and easier to maintain/audit.
- **2026-02-27** > apps/gateway-orchestrator/src/orchestrator/tool_policy_engine.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/orchestrator/types.ts, tests/unit/tool_policy_engine.test.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/orchestrator_phases.test.ts, docs/progress.md > `TOOL_SPECS_V1`, `evaluateToolPolicy`, `GatewayService.evaluateToolPolicy`, `recordToolUsage` safety metadata > Added ToolSpec v1 registry and centralized tool-policy evaluation (safety tiers + capability gating), rewired gateway web/file/shell command checks to use typed tool policy decisions, and expanded observability/test coverage for tool-tier metadata and approval behavior.
- **2026-02-27** > docs/adr/0001-gateway-control-plane-and-agentic-runtime.md, docs/agentic_vision.md, docs/detailed_project_plan.md, docs/progress.md > ADR 0001 architecture lock > Added an ADR that formalizes the project’s core direction: channels are transport lanes only, gateway is orchestration source-of-truth, runtime is agentic-by-default with selective structured runs, and workers remain execution plane rather than orchestration authority.
- **2026-02-27** > docs/channel_control_plane_architecture.md, docs/agentic_vision.md, docs/detailed_project_plan.md, docs/features.md, docs/progress.md > channel input-lane contract + gateway control-plane lock > Added a locked architecture spec that forces channels to remain thin transport adapters and centralizes all orchestration phases (normalize/session/directives/plan/policy/route/persist/dispatch) in gateway, with a concrete WhatsApp reference flow and cross-doc links so future channel additions cannot bypass control-plane behavior.
- **2026-02-27** > apps/worker/src/execution/processor.ts, apps/worker/src/execution/status_handler.ts, apps/worker/src/worker.ts, apps/gateway-orchestrator/src/local_queue_store.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/ui/render_ui_home.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, packages/contracts/src/job.ts, tests/unit/worker_execution_modules.test.ts, tests/unit/worker_status_handler.test.ts, docs/progress.md > `processAgenticTurnTask`, `reportProgress`, `normalizeProgressText`, `updateJobProgress`, `health` active-job projection > Added phase/detail-aware worker progress telemetry, surfaced phase context in gateway health/UI, rewired agentic research flow to rank-first synthesis with SearXNG-first retrieval + weak-coverage fallback/clarification handling, and replaced first-link provisional recommendation fallback with ranked-candidate recommendation logic plus updated unit coverage.
- **2026-02-27** > apps/worker/src/execution/processor.ts, apps/worker/src/execution/status_handler.ts, apps/worker/src/worker.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/ui/render_ui_home.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/worker_execution_modules.test.ts, tests/unit/worker_status_handler.test.ts, docs/progress.md > `agentic_turn` synthesis budget/pulse updates, friendly fallback formatting, worker status UX, health active-job observability > Added periodic in-flight progress pulses for long search/synthesis, reduced synthesis stall window, replaced raw fallback dumps with concise shortlist + provisional recommendation, made WhatsApp job updates more user-friendly, propagated `workerId` through worker status events, and exposed active running job details in `/health` + UI source snapshots.
- **2026-02-27** > apps/gateway-orchestrator/src/builtins/web_search_service.ts, apps/gateway-orchestrator/src/server.ts, apps/worker/src/server.ts, tests/unit/web_search_service.test.ts, docs/progress.md > `searchWithOpenAi` timeout guard + auto-provider fallback reliability > Added bounded OpenAI web-search timeout and wired it from runtime config so `provider=auto` no longer stalls on long OpenAI/Codex web turns; service now falls through quickly to SearXNG and includes regression coverage for timeout fallback behavior.
- **2026-02-27** > apps/gateway-orchestrator/src/gateway_service.ts, apps/worker/src/execution/processor.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/worker_execution_modules.test.ts, docs/progress.md > `detectLongTaskRoute`, planner `web_research` routing, worker `taskType=agentic_turn` execution + synthesis fallback tests > Switched default long research routing to `agentic_turn` (hybrid/agentic path), kept explicit `/web` command on deterministic `web_search`, and added worker coverage for synthesized responses plus raw-context fallback when synthesis fails.
- **2026-02-27** > docs/agentic_vision.md, docs/detailed_project_plan.md, docs/features.md, docs/progress.md > hybrid execution model lock (agentic default + selective structured mode) > Clarified that Alfred should run agentic-by-default for unknown tasks and use structured RunSpec execution selectively for high-risk/repeatable paths, with command surfaces remaining operator fallback.
- **2026-02-27** > docs/agentic_vision.md, docs/alfred_identity.md, docs/detailed_project_plan.md, docs/features.md, docs/progress.md > locked agent-first project direction and tool-mediated execution principle > Added a dedicated vision document and linked it across identity/plan/features to enforce that Alfred’s primary UX is natural-language planning + tool execution, with slash commands treated as operator/debug fallback.
- **2026-02-27** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/app_types.ts, docs/progress.md > `CreateGatewayAppOptions` type extraction > Moved the large gateway app options contract into a dedicated type module so `app.ts` focuses on runtime composition and route wiring.
- **2026-02-27** > apps/worker/src/server.ts, apps/worker/src/runtime/codex_runtime.ts, tests/unit/worker_codex_runtime.test.ts, docs/progress.md > `ensureWorkerCodexRuntime` startup guard and worker LLM bootstrap ordering > Added a dedicated Codex runtime bootstrap guard for worker startup, moved hybrid LLM/web-search service construction to after Codex readiness resolution, and ensured Codex chat is not retained when auth bootstrap fails.
- **2026-02-27** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/routes/core_routes.ts, docs/progress.md > `registerCoreRoutes` extraction from `createGatewayApp` > Moved root/UI/health route handlers into a dedicated core-routes module so app bootstrap primarily wires dependencies and route modules.
- **2026-02-27** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/routes/heartbeat_routes.ts, docs/progress.md > `registerHeartbeatRoutes` extraction from `createGatewayApp` > Moved heartbeat status/configure/run endpoints into a dedicated route module so heartbeat schema validation and handler flow are isolated from app bootstrap wiring.
- **2026-02-27** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/routes/channel_routes.ts, docs/progress.md > `registerChannelRoutes` extraction from `createGatewayApp` > Moved identity mapping, inbound message handling, Baileys inbound/live status routes, and jobs APIs into a dedicated channel route module while preserving token-auth, QR payload, and async-job response behavior.
- **2026-02-27** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/routes/memory_routes.ts, docs/progress.md > `registerMemoryRoutes` extraction from `createGatewayApp` > Moved memory API handlers (`status/sync/search/snippet/notes` plus compaction/checkpoint endpoints) into a dedicated route module and kept `app.ts` focused on dependency wiring/composition.
- **2026-02-27** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/routes/auth_routes.ts, docs/progress.md > `registerAuthRoutes` extraction from `createGatewayApp` > Moved OpenAI/Codex auth HTTP routes (start/status/disconnect/callback/rate-limits/mock-authorize) into a dedicated route module and rewired app composition to pass auth dependencies, reducing `app.ts` complexity while preserving auth endpoint behavior.
- **2026-02-27** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/routes/observability_routes.ts, docs/progress.md > `registerObservabilityRoutes` extraction from `createGatewayApp` > Split stream/run/supervisor/approval API handlers into a dedicated observability route module and rewired app composition to inject only required dependencies, reducing `app.ts` route density while preserving API behavior.
- **2026-02-27** > apps/gateway-orchestrator/src/gateway_service.ts, docs/progress.md > `handlePlannerFallbackRoutes` extraction and async sequencing fix in `handleInbound` > Extracted planner-fallback routing into a dedicated helper and fixed async `try/finally` sequencing (`return await` on helper paths) so run-ledger phase/persist writes complete before finalization, preventing concurrent run-file write races during command/approval fallback handling.
- **2026-02-26** > apps/gateway-orchestrator/src/orchestrator/types.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/orchestrator_phases.test.ts, docs/progress.md > shared `PlannerDecision`/`LlmAuthPreference` typing across app+service > Consolidated planner/auth preference contracts into shared orchestrator types and reused them across gateway app/service wiring to reduce duplicated type drift risk during future orchestration refactors.
- **2026-02-26** > apps/gateway-orchestrator/src/ui/shared_shell.ts, apps/gateway-orchestrator/src/ui/render_ui_home.ts, apps/gateway-orchestrator/src/ui/render_ui_transcripts.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/ui_split_pages.test.ts, docs/progress.md > `renderUiHeader` shared UI shell extraction > Refactored shared UI header/navigation markup into a reusable helper so status/transcript/console pages stay consistent and easier to maintain without changing page behavior.
- **2026-02-26** > apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/orchestrator_phases.test.ts, docs/progress.md > `handlePlannerPrimaryRoutes` extraction > Refactored planner-primary intent routing (`clarify`, `status_query`, `web_research`) into a dedicated helper so policy/route handling is separated from the inbound coordinator while preserving current planner behavior and responses.
- **2026-02-26** > apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/orchestrator_phases.test.ts, docs/progress.md > `handlePrePlannerDirectiveSurface` extraction from `handleInbound` > Extracted pre-planner directive routing (paging, command execution, implicit approvals, progress queries) into a dedicated helper to further separate directive handling from planner/policy routing while preserving response behavior.
- **2026-02-26** > apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/orchestrator_phases.test.ts, docs/progress.md > `handleBusySession`, `handleExplicitJobRequest` extraction from `handleInbound` > Refactored gateway inbound orchestration by extracting busy-session queue handling and explicit async-job request routing into dedicated methods, reducing `handleInbound` branching complexity while keeping behavior and response shapes unchanged.
- **2026-02-26** > docs/detailed_project_plan.md, docs/features.md, docs/progress.md > architecture notes for hybrid planning handshake and WASM defer > Updated planning/features docs to lock worker-proposed/gateway-approved hybrid planning semantics and explicitly defer WASM sandbox implementation until post-refactor stabilization.
- **2026-02-26** > apps/worker/src/execution/processor.ts, apps/worker/src/execution/status_handler.ts, apps/worker/src/server.ts, apps/worker/src/run_spec_executor.ts, tests/unit/worker_execution_modules.test.ts, tests/unit/worker_progress.test.ts, tests/unit/run_spec_executor.test.ts, docs/progress.md > `createWorkerProcessor`, `createWorkerStatusHandler`, executor interface decoupling > Refactored worker runtime into modular execution/notification handlers, kept legacy task behavior intact, and decoupled RunSpec executor from concrete class types to explicit service interfaces so worker orchestration boundaries are clearer and easier to evolve.
- **2026-02-26** > apps/gateway-orchestrator/src/orchestrator/types.ts, apps/gateway-orchestrator/src/orchestrator/normalize_phase.ts, apps/gateway-orchestrator/src/orchestrator/session_phase.ts, apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/orchestrator_phases.test.ts, tests/unit/gateway_service_llm.test.ts, docs/progress.md > `runNormalizePhase`, `runSessionPhase`, `GatewayService.handleInbound` phase wiring > Extracted normalize/session orchestration phases into dedicated modules and rewired inbound handling to use phase contexts/markers while preserving existing directive/planner/policy/route behavior and run-ledger semantics.
- **2026-02-26** > packages/contracts/src/planning.ts, packages/contracts/src/index.ts, tests/unit/planning_contracts.test.ts, docs/progress.md > `PlanProposalSchema`, `PlanDecisionSchema`, `RunSpecLockSchema` > Added formal hybrid planning contracts so worker-side plan proposals and gateway run-spec decisions/locks are explicitly typed and test-validated for immutable execution handoff.
- **2026-02-26** > apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, tests/unit/baileys_runtime.test.ts, docs/progress.md > removed automatic partial-creds reset during connect > Disabled auto backup/reset of `creds.json` on connect because it could erase valid post-scan transitional auth state and cause endless re-registration loops; pairing recovery is now handled by reconnect logic (including restart-required code 515) without destructive auth mutation.
- **2026-02-26** > apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, tests/unit/baileys_runtime.test.ts, docs/progress.md > `handleConnectionUpdate` restart-required branch + `safeDisconnectCode` fallback parsing > Added explicit recovery for Baileys `stream:error code=515` (restart required) even when no `connection:"close"` event is emitted, forcing socket recycle and fast reconnect; expanded disconnect-code parsing to read `error.data.attrs.code` and added regression test coverage.
- **2026-02-26** > apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, tests/unit/baileys_runtime.test.ts, docs/progress.md > `repairPartialCreds`, partial-auth recovery test coverage > Added a Baileys startup guard that detects interrupted pairing state (`registered=false` with persisted account/me), backs up stale `creds.json`, and forces a clean relink path so runtime no longer gets stuck in passive-login 428/1006 reconnect loops without QR.
- **2026-02-26** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/ui/render_ui_home.ts, apps/gateway-orchestrator/src/ui/render_ui_transcripts.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/ui_split_pages.test.ts, tests/unit/web_console_ui.test.ts, docs/progress.md > `/ui` route split, dedicated transcripts page, console log cap > Split the web UI into three pages (`/ui`, `/ui/transcripts`, `/ui/console`) so status/bindings, transcript viewing, and operational console are separated; added a 500-entry in-browser cap for console logs and updated route/UI tests.
- **2026-02-26** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/builtins/web_search_service.ts, apps/worker/src/server.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/web_search_service.test.ts, docs/progress.md > directive-first approval routing, balanced-mode single-step `web_to_file` approval, `auto` provider preference, worker run failure semantics > Fixed approval UX/regression where `yes/no` could be misrouted to planner clarify; implicit approvals now resolve before planning, balanced mode now gates only the write step for `web_to_file`, planner/approval `web_to_file` paths default to `provider=auto`, `auto` provider now prioritizes OpenAI path before SearXNG fallback, and RunSpec failures now propagate as failed jobs instead of succeeded completions.
- **2026-02-26** > packages/contracts/src/run_spec.ts, packages/contracts/src/index.ts, apps/gateway-orchestrator/src/builtins/run_spec_store.ts, apps/worker/src/run_spec_executor.ts, apps/worker/src/server.ts > `RunSpecV1Schema`, `RunSpecStore.put/get/updateStep/grantStepApproval`, `executeRunSpec`, worker `taskType=run_spec` dispatch > Added RunSpec v1 contract + durable store + generic worker step executor and migrated `web_to_file` execution to RunSpec steps (`web.search`, `doc.compose`, `file.write`, `channel.send_attachment`) with timeline/state persistence.
- **2026-02-26** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts > `requestNextRunSpecApprovalIfNeeded`, `executeApprovedAction(run_spec_step)`, `enqueueRunSpecJob`, `/v1/runs/:runId`, `Run Timeline` UI actions > Added per-step RunSpec approval checkpoints, sequential approval continuation, run-spec queuing path, run-detail API response enrichment (`runSpec` block), and web-console run timeline controls (`List Runs`, `Run Status`) with step-status logging.
- **2026-02-26** > tests/unit/run_spec_store.test.ts, tests/unit/run_spec_executor.test.ts, tests/unit/gateway_service_llm.test.ts, tests/integration/skill_install_and_run.test.ts > RunSpec store/executor coverage, planner approval-flow assertions, integration timeout stabilization > Added unit coverage for RunSpec lifecycle/execution, updated gateway planner tests for per-step approval + `run_spec` payload routing, and increased skill-install integration timeout to reduce CI/local flake timeouts.
- **2026-02-26** > docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > RunSpec v1 acceptance criteria, phase-6 deliverables, progress/task checkpoints, manual run-timeline checks > Updated planning/docs/manual checklist to track RunSpec v1 rollout, step-approval behavior, and operator run timeline validation expectations.
- **2026-02-26** > apps/gateway-orchestrator/src/builtins/intent_planner.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/worker/src/server.ts, tests/unit/intent_planner.test.ts, tests/unit/gateway_service_llm.test.ts, docs/alfred_capabilities.md, docs/alfred_policies.md, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > planner `sendAttachment` decision path, gateway `web_to_file` routing/approval, worker `web_to_file` task execution > Added an LLM-orchestrated research-to-deliverable path so a natural-language request can queue one worker task that performs web search, drafts a document, writes it in workspace, and sends it as a WhatsApp attachment with side-effect approvals enforced by policy.
- **2026-02-26** > apps/gateway-orchestrator/src/builtins/command_parser.ts, apps/gateway-orchestrator/src/builtins/reminder_store.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/notification_store.ts, apps/gateway-orchestrator/src/notification_dispatcher.ts, packages/provider-adapters/src/whatsapp_adapter.ts, packages/provider-adapters/src/baileys_adapter.ts, apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts > parseCommand calendar/file commands, ReminderStore.cancel, GatewayService executeFileSend/validateAttachmentPath, notification file-delivery flow > Added calendar commands (`/calendar add|list|cancel`) and WhatsApp attachment delivery (`/file send`) for workspace `.md/.txt/.doc` files with approval-aware execution and adapter/runtime support for file notifications.
- **2026-02-26** > tests/unit/command_parser.test.ts, tests/unit/baileys_runtime.test.ts, tests/unit/gateway_service_llm.test.ts, tests/integration/reminders_and_commands.test.ts, tests/integration/baileys_async_updates.test.ts, docs/alfred_capabilities.md, docs/alfred_policies.md, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > calendar/file-send test coverage and docs/manual workflow updates > Added unit/integration coverage for new calendar and file-attachment paths and updated capability/policy/plan/progress/manual-check documentation for operator testing.
- **2026-02-26** > apps/gateway-orchestrator/src/builtins/web_search_service.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts, apps/gateway-orchestrator/src/builtins/supervisor_store.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts, apps/worker/src/server.ts, .env.example, tests/unit/web_search_service.test.ts, tests/unit/config.test.ts, tests/unit/command_parser.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > SearXNG/BrightData provider wiring and provider-matrix expansion > Added SearXNG as the default `/web` provider plus optional BrightData provider support, expanded command/config/provider unions (`searxng`, `openai`, `brave`, `perplexity`, `brightdata`, `auto`), wired env/runtime settings for SearXNG and BrightData in gateway+worker, and updated tests/docs/manual checklist for comparative provider validation.
- **2026-02-26** > .gitignore > ignore runtime memory folder > Added `memory/` to gitignore so local conversational memory logs are not committed.
- **2026-02-25** > apps/gateway-orchestrator/src/builtins/memory_checkpoint_service.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/notification_dispatcher.ts, apps/gateway-orchestrator/src/builtins/memory_compaction_service.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/memory_checkpoint_service.test.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/memory_compaction_service.test.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/web_console_ui.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > MemoryCheckpointService.checkpoint/status, gateway class-aware memory retrieval + checkpoint hooks, compaction class tagging > Implemented Memory V2 autonomy foundations: durable checkpoint memory writes at decision/task/job boundaries with dedupe/day-cap guards, class-aware retrieval (`fact`/`preference`/`todo`/`decision`) for chat memory context, class-distribution tags in compaction digests, and new checkpoint status visibility via API/UI.
- **2026-02-25** > apps/gateway-orchestrator/src/builtins/approval_store.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/approval_store.test.ts, tests/unit/command_parser.test.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/gateway_app_ui_route.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > ApprovalStore.listBySession/listPending, parseCommand approval commands, createGatewayApp approvals routes > Added Policy/Approval V2 controls with pending-approval visibility (`/approval pending`, `GET /v1/approvals/pending`) and cross-channel resolution (`yes/no`, `approve/reject <token>`, `POST /v1/approvals/resolve`), plus route/command/store tests and updated docs/manual validation.
- **2026-02-25** > apps/gateway-orchestrator/src/builtins/supervisor_store.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts, apps/worker/src/server.ts, apps/gateway-orchestrator/src/config.ts, .env.example, tests/unit/supervisor_store.test.ts, tests/unit/command_parser.test.ts, tests/unit/config.test.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/worker_progress.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > SupervisorStore.createWebFanout/updateChildByJob, commandParser supervise/supervisor status paths, worker concurrency + bounded retries/time budgets > Added gateway-supervised multi-child web fan-out (`/supervise web`), persisted supervisor parent/child state with status APIs, worker concurrency control (`WORKER_CONCURRENCY`), queued follow-up chat-turn execution while sessions are busy (`queueMode=collect|followup`), and child budget/retry/time-bound execution semantics with test and manual coverage updates.
- **2026-02-25** > apps/gateway-orchestrator/src/builtins/run_ledger_store.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts, tests/unit/run_ledger_store.test.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/gateway_app_ui_route.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > RunLedgerStore.startRun/transitionPhase/appendEvent/completeRun and gateway handleInbound phase instrumentation > Added a durable turn run ledger with explicit orchestration phase transitions, immutable run-spec basics (session/idempotency/model/provider/policy/skills snapshots), session-busy run blocking records, and new run inspection APIs (`/v1/runs`, `/v1/runs/:runId`) with automated/manual coverage.
- **2026-02-25** > docs/detailed_project_plan.md, docs/features.md, docs/alfred_capabilities.md, docs/progress.md > architecture-decision lock for orchestration model > Documented and locked the control-plane/execution-plane split: gateway remains Alfred’s turn orchestrator (session/planning/policy/routing/persistence/delivery), worker remains long/background execution plane, and future semi-autonomous fan-out should scale via worker/subagent supervision rather than collapsing orchestration into execution.
- **2026-02-25** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/web_console_ui.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > handleInbound planner trace emission, pushStreamEvent planner trace labeling, renderSessionTranscript planner tagging > Added explicit planner decision tracing (intent/confidence/reason/chosen action) to the unified conversation stream with `STREAM_PLANNER_TRACE` UI labeling, transcript planner tags, unit coverage, and updated planning/progress/manual-check docs for operator observability.
- **2026-02-25** > apps/gateway-orchestrator/src/builtins/intent_planner.ts, apps/gateway-orchestrator/src/builtins/system_prompt_catalog.ts, docs/alfred_identity.md, docs/alfred_capabilities.md, docs/alfred_policies.md, apps/gateway-orchestrator/src/gateway_service.ts, apps/worker/src/server.ts, apps/gateway-orchestrator/src/config.ts, .env.example, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/app.ts, tests/unit/intent_planner.test.ts, tests/unit/config.test.ts, tests/unit/gateway_service_llm.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > IntentPlanner.plan, SystemPromptCatalog.load, balanced approval policy enforcement, worker progress throttling > Added planner-first orchestration for non-command chat with confidence-based clarification fallback, markdown-driven Alfred system-prompt stack, `ALFRED_APPROVAL_MODE` (`strict|balanced|relaxed`) with balanced defaults, and cleaner user-facing worker progress notifications while preserving final status/results.
- **2026-02-25** > apps/gateway-orchestrator/src/gateway_service.ts, apps/worker/src/server.ts, apps/worker/src/worker.ts, apps/gateway-orchestrator/src/local_queue_store.ts, packages/contracts/src/job.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/builtins/paged_response_store.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/worker_progress.test.ts, tests/unit/paged_response_store.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > routeLongTaskIfNeeded, enqueueLongTaskJob, answerProgressQuery, worker progress reporting, paged response continuation > Routed `/web` and research-style long requests to worker jobs with immediate acknowledgement, worker progress/status notifications, progress-aware `status?` replies, and session-scoped `#next` paged result continuation to prevent silent long waits.
- **2026-02-25** > apps/gateway-orchestrator/src/builtins/memory_compaction_service.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/config.ts, .env.example, tests/unit/memory_compaction_service.test.ts, tests/unit/config.test.ts, tests/unit/gateway_app_ui_route.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > MemoryCompactionService.start/runNow/status, createGatewayApp memory compaction routes, loadConfig memory compaction env parsing > Added a daily memory compaction subsystem that summarizes prior-day conversation events into bounded memory notes with persistent cursor state, startup/interval scheduling, manual status/run APIs, stream-visible memory compaction signals, env-configurable thresholds, and automated/manual coverage updates.
- **2026-02-25** > apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/gateway_service_llm.test.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > in-flight web-search progress notifications > Added best-effort `running` status notifications before `/web` execution (including approved web-search actions) so WhatsApp/UI streams surface immediate “working” feedback during slower provider calls.
- **2026-02-25** > apps/gateway-orchestrator/src/builtins/approval_store.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts, apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/approval_store.test.ts, tests/unit/command_parser.test.ts, tests/unit/gateway_service_llm.test.ts, tests/integration/reminders_and_commands.test.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > tokenless yes/no approval resolution > Added latest-pending approval lookup/consume APIs and gateway handling so `yes` approves or `no` rejects the latest pending action per session (web + WhatsApp), while keeping token-based `approve <token>`/`reject <token>` paths and updating tests/docs/manual validation.
- **2026-02-25** > apps/gateway-orchestrator/src/ui/render_web_console.ts, docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > provider-aware operator docs and UI command hinting > Updated `/ui` quick-command guidance and project docs/manual checklist to cover provider-selectable `/web --provider=...` execution (`openai`, `brave`, `perplexity`, `auto`) and validation flow.
- **2026-02-25** > apps/gateway-orchestrator/src/builtins/web_search_service.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts, tests/unit/web_search_service.test.ts, tests/unit/gateway_service_llm.test.ts > multi-provider web-search runtime execution > Added routed `/web` execution with provider-aware runtime (`openai`, `brave`, `perplexity`, `auto`) including Brave and Perplexity HTTP integration, fallback ordering, approval-payload provider persistence, and unit coverage for provider-specific behavior and fallback.
- **2026-02-25** > apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts, .env.example, tests/unit/config.test.ts, tests/unit/command_parser.test.ts > multi-provider web-search configuration and command parsing > Added web-search provider config/env support (`openai`/`brave`/`perplexity`/`auto`), Brave/Perplexity API runtime settings, and `/web --provider=...` command parsing with unit coverage.
- **2026-02-25** > apps/gateway-orchestrator/src/builtins/conversation_store.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/conversation_store.test.ts, tests/unit/web_console_ui.test.ts > daily transcript filtering (`since`/`until`) and UI day selector > Added day-bounded transcript queries with `until` support and a `/ui` transcript date picker defaulting to today so operators can review per-day logs without loading oversized full-history transcript views.
- **2026-02-25** > apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts, apps/gateway-orchestrator/src/gateway_service.ts, .env.example, .gitignore, tests/unit/config.test.ts, tests/unit/command_parser.test.ts, tests/unit/gateway_service_llm.test.ts, docs/detailed_project_plan.md, docs/features.md, docs/progress.md > capability policy defaults, workspace sandboxing, `/web` and `/write` command controls > Added env-configurable approval-by-default capability policy, dedicated gitignored Alfred workspace bootstrap, policy-aware `/web` research and workspace-scoped `/write` command flows with approval gating, and automated/unit documentation updates for manual verification.
- **2026-02-25** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts > consolidated transcript mode and sticky heartbeat edits > Added transcript `All sessions` mode so persisted chat/command events from every session render in one panel, and prevented heartbeat form inputs from being overwritten by polling while operator edits are in progress.
- **2026-02-25** > apps/gateway-orchestrator/src/whatsapp/live_inbound_relay.ts, tests/unit/live_inbound_relay.test.ts > maybeSendBaileysChatReply JID validation > Fixed live WhatsApp reply relay to allow `@lid` sender IDs (in addition to `@s.whatsapp.net`) so inbound LID chats receive outbound bot replies on device.
- **2026-02-25** > apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/baileys_runtime.test.ts > @lid inbound compatibility and ingress filter observability > Added support for `@lid` WhatsApp JIDs in inbound/outbound validation, canonical sender allowlist matching, and explicit ignored-message counters (`unsupportedJid`, `fromMe`, `senderNotAllowed`, `missingPrefix`) surfaced in live status/UI to diagnose silent inbound drops.
- **2026-02-24** > apps/gateway-orchestrator/src/builtins/heartbeat_service.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, .env.example, tests/unit/heartbeat_service.test.ts, tests/unit/config.test.ts, tests/unit/web_console_ui.test.ts, docs/detailed_project_plan.md, docs/features.md, docs/progress.md, scripts/test-manual-checklist > heartbeat dependency signal checks > Extended heartbeat to explicitly detect OpenAI auth disconnect, WhatsApp disconnect, and long-running jobs with configurable alert toggles/thresholds, plus updated UI controls and test coverage.
- **2026-02-24** > apps/gateway-orchestrator/src/builtins/heartbeat_service.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, .env.example, tests/unit/heartbeat_service.test.ts, tests/unit/config.test.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/web_console_ui.test.ts, docs/detailed_project_plan.md, docs/features.md, docs/progress.md, scripts/test-manual-checklist > HeartbeatService and heartbeat API/UI controls > Added heartbeat reliability loop with persistent state, active-hour/idle-queue gating, deduped alert delivery, `/v1/heartbeat/status|configure|run` endpoints, `/ui` heartbeat controls/source observability, config/env plumbing, and automated/manual test coverage.
- **2026-02-24** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts > transcript-frame container > Wrapped persisted transcript in a dedicated `.transcript-frame` container capped at `800px`, with the inner `<pre>` set to fill/wrap inside the frame to prevent panel-level width expansion.
- **2026-02-24** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts > sessionTranscript fixed-width cap > Capped persisted transcript width to `800px` (`min(100%, 800px)`) so long responses stay readable without excessive horizontal scrolling, with updated UI assertions.
- **2026-02-24** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts > sessionTranscript CSS containment > Prevented long unbroken transcript lines from expanding `/ui` layout by enforcing wrapped, scrollable, fixed-width transcript rendering and added UI test assertions for overflow guards.
- **2026-02-24** > apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/gateway_service_llm.test.ts > prepareChatInput, shouldUseProviderManagedContext > Reduced token/context duplication by disabling app transcript injection when `openai-codex` provider-thread context is active (except forced `api_key` mode), with unit coverage for both paths.
- **2026-02-24** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts > renderSessionTranscript > Fixed `/ui` script parse failure by escaping transcript newline join/whitespace regex in generated HTML script so button handlers bind and UI actions execute.
- **2026-02-23** > docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > phase 6 continuity docs and validation > Updated planning/feature/progress docs and manual checklist to include persisted transcript UX and restart-safe recent-conversation context continuity.
- **2026-02-23** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/web_console_ui.test.ts > prepareChatInput, buildRecentConversationContext, renderSessionTranscript > Added restart-safe conversation continuity by injecting bounded recent session transcript into chat prompts and exposing a persisted transcript panel in `/ui` with auto-refresh and manual refresh controls.
- **2026-02-23** > docs/features.md, docs/detailed_project_plan.md, docs/progress.md, scripts/test-manual-checklist > phase 6 documentation and manual validation updates > Updated MVP docs and manual test checklist to cover stream retention/noise controls, auth preference testing paths, and memory-reference validation in chat.
- **2026-02-23** > apps/gateway-orchestrator/src/builtins/conversation_store.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/llm/hybrid_llm_service.ts, apps/gateway-orchestrator/src/llm/openai_responses_service.ts, apps/gateway-orchestrator/src/whatsapp/normalize_baileys.ts, .env.example, tests/unit/conversation_store.test.ts, tests/unit/config.test.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/hybrid_llm_service.test.ts, tests/unit/openai_responses_service.test.ts, tests/unit/web_console_ui.test.ts, tests/integration/baileys_async_updates.test.ts, tests/smoke/phase2_smoke.test.ts > ConversationStore.query, stream event filters, executeChatTurn memory injection, authPreference routing > Added stream retention/noise controls with queryable filtered stream API + UI noisy-toggle, explicit per-request LLM auth preference (`auto`/`oauth`/`api_key`) routing, non-silent no-backend chat guidance, and memory-aware prompt injection with source references in chat responses.
- **2026-02-23** > docs/detailed_project_plan.md, docs/features.md, docs/progress.md, scripts/test-manual-checklist > Phase 6 deliverables, WhatsApp acceptance criteria, Live WhatsApp manual checklist > Documented history-sync noise filtering scope and added explicit manual validation for accepted-vs-ignored inbound counters to guard context bloat.
- **2026-02-23** > apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/baileys_runtime.test.ts > BaileysRuntime.handleMessagesUpsert, safeMessageTimestampSeconds, trackSeenMessageKey, renderWaLiveSummary > Added WhatsApp history-sync noise filtering (drop non-`notify`, stale pre-live, and duplicate inbound messages) before model routing, and surfaced sync counters (`accepted`/`ignored`) in live status UI for observability/context-bloat control.
- **2026-02-23** > apps/gateway-orchestrator/src/auth/identity_profile_store.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/builtins/conversation_store.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/identity_profile_store.test.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/conversation_store.test.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/web_console_ui.test.ts, docs/features.md, docs/detailed_project_plan.md, scripts/test-manual-checklist > SSE stream + identity profile routing > Added server-sent events stream subscription (`/v1/stream/events/subscribe`) with UI real-time feed and poll fallback, plus persisted WhatsApp JID to auth-session mappings and automatic mapped-auth routing for WhatsApp inbound OAuth/LLM flows.
- **2026-02-23** > apps/gateway-orchestrator/src/builtins/conversation_store.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/notification_dispatcher.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, tests/unit/conversation_store.test.ts, tests/unit/baileys_runtime.test.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/web_console_ui.test.ts, docs/features.md, docs/detailed_project_plan.md, scripts/test-manual-checklist, docs/progress.md > unified interaction stream and WhatsApp session persistence > Added persisted backend interaction stream events (`/v1/stream/events`) wired into `/ui` polling for a single cross-source console feed, logged gateway/WhatsApp/worker activity into the stream, and changed Baileys runtime shutdown behavior to preserve linked-device auth state across gateway restarts (no implicit logout on stop).
- **2026-02-23** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts, docs/features.md, docs/detailed_project_plan.md, scripts/test-manual-checklist > source-level console observability > Added source status cards and change-feed logging (Gateway/Auth/WhatsApp/Memory) with auto-polling, deduped source-change events, and manual refresh controls in `/ui` to track cross-service state in one place.
- **2026-02-23** > apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/whatsapp/live_inbound_relay.ts, tests/unit/live_inbound_relay.test.ts > live WhatsApp chat reply relay > Fixed live Baileys inbound handling to dispatch chat-mode gateway responses back to the originating WhatsApp JID, with unit coverage for reply/no-reply branching.
- **2026-02-23** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/whatsapp_live_qr_image_data.test.ts, tests/unit/web_console_ui.test.ts, package.json, package-lock.json, docs/features.md, docs/detailed_project_plan.md, scripts/test-manual-checklist > WhatsApp QR renderer reliability (no CDN dependency) > Added backend QR image generation (`qrImageDataUrl`) for live status/connect/disconnect responses and switched UI to consume backend QR payloads instead of browser CDN QR library, with unit coverage for QR data rendering helper.
- **2026-02-23** > apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts, .env.example, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/baileys_runtime.test.ts, tests/unit/config.test.ts, tests/unit/web_console_ui.test.ts, scripts/test-manual-checklist, docs/features.md, docs/detailed_project_plan.md > WhatsApp QR churn guard and auto-refresh UX > Added capped QR generation per connect window (`WHATSAPP_BAILEYS_MAX_QR_GENERATIONS`, default `3`) with lock state requiring manual reconnect, and added silent UI live-status polling so QR image/raw payload refresh automatically without repeated `Live Status` clicks.
- **2026-02-23** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts > renderWaQrPreview and live setup scan UX > Added a direct scannable WhatsApp QR image block in `/ui` (with raw QR fallback), wired QR rendering hints for connect states, and expanded UI unit assertions for the new QR elements.
- **2026-02-23** > apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts, .env.example, tests/unit/config.test.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, scripts/test-manual-checklist > deprecated terminal qr removal > Removed deprecated `printQRInTerminal` runtime usage and corresponding config/env references; setup now relies on live status/UI QR data instead of terminal QR output.
- **2026-02-23** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts > intuitive live whatsapp setup UI > Added a guided WhatsApp setup section (state badge, next-step guidance, raw QR view, and one-click `.env` setup snippet copy) to make live Baileys onboarding clearer from the web console.
- **2026-02-23** > apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, apps/gateway-orchestrator/src/server.ts, .env.example, tests/unit/config.test.ts, tests/unit/baileys_runtime.test.ts, scripts/test-manual-checklist, docs/features.md, docs/detailed_project_plan.md > safe single-number whatsapp test controls > Added required-prefix gating (`/alfred`), optional `fromMe` self-test mode, and sender allowlist controls for Baileys live ingress with config/runtime/unit-test/manual-doc coverage.
- **2026-02-23** > apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, apps/gateway-orchestrator/src/server.ts, .env.example, tests/unit/config.test.ts, scripts/test-manual-checklist > Baileys QR operator flow > Added `WHATSAPP_BAILEYS_PRINT_QR` configuration (default enabled) and runtime wiring so QR is printed in gateway logs for easier linked-device onboarding.
- **2026-02-23** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts, scripts/test-manual-checklist, docs/features.md, docs/detailed_project_plan.md > live whatsapp controls and docs > Added web console controls/boot status for live WhatsApp connect-status-disconnect flows, expanded manual checklist for linked-device validation, and updated feature/plan docs to include production Baileys runtime expectations.
- **2026-02-23** > package.json, package-lock.json, apps/gateway-orchestrator/src/whatsapp/baileys_runtime.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/config.ts, .env.example, tests/unit/config.test.ts, tests/unit/baileys_runtime.test.ts, tests/unit/baileys_inbound_auth.test.ts, tests/unit/gateway_app_ui_route.test.ts > live WhatsApp Baileys runtime and security gating > Added real Baileys runtime wiring (connect/reconnect/disconnect, persisted auth dir, inbound relay, outbound adapter), provider/config/env controls, live status/connect/disconnect API routes, and inbound token authorization checks with unit coverage.
- **2026-02-23** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts > UI interaction state and console ordering controls > Added broader per-button in-flight feedback, clearer status coloring, OAuth auth-summary rendering with persisted telemetry, and a default `Newest first` console mode with clear-console control.
- **2026-02-23** > apps/gateway-orchestrator/src/codex/auth_state_store.ts, apps/gateway-orchestrator/src/codex/auth_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts, tests/unit/codex_auth_service.test.ts > codex auth telemetry persistence > Added durable auth telemetry state (`lastLogin`, `lastDisconnectAt`, last status check/snapshot/error), wired status endpoint to return telemetry across restarts, and added unit coverage for persistence behavior.
- **2026-02-23** > apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/web_console_ui.test.ts > sendChat/sendJob in-flight UI feedback > Added immediate request logging (`SEND_CHAT_REQUEST`/`SEND_JOB_REQUEST`), busy/success/error status states, and temporary send-button disablement while requests are in flight.
- **2026-02-23** > apps/gateway-orchestrator/src/llm/codex_chat_service.ts, apps/gateway-orchestrator/src/llm/hybrid_llm_service.ts, tests/unit/codex_chat_service.test.ts, tests/unit/hybrid_llm_service.test.ts > codex event parsing and fallback error propagation > Added assistant content-array text extraction, richer turn failure surfacing, and hybrid fallback behavior that raises Codex errors when no fallback result exists (instead of returning silent `ack`).
- **2026-02-23** > apps/gateway-orchestrator/src/llm/codex_chat_service.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, tests/unit/codex_chat_service.test.ts > generateText retry path and web auth boot status > Added stale-thread retry recovery for Codex turns after restart, boot-time OAuth status visibility in the web console, and unit coverage for the recovery flow.
- **2026-02-23** > scripts/test-manual-checklist, docs/features.md, docs/detailed_project_plan.md, docs/progress.md > codex setup and tracking docs > Added Codex app-server manual validation steps and updated feature/plan/progress docs for OAuth-first Codex runtime.
- **2026-02-23** > apps/gateway-orchestrator/src/codex/app_server_client.ts, apps/gateway-orchestrator/src/codex/auth_service.ts, apps/gateway-orchestrator/src/codex/thread_store.ts > Codex app-server client/auth/session thread state > Added stdio JSON-RPC Codex app-server client with initialize lifecycle, account auth/rate-limits wrappers, and file-backed per-session thread mapping.
- **2026-02-23** > apps/gateway-orchestrator/src/llm/codex_chat_service.ts, apps/gateway-orchestrator/src/llm/hybrid_llm_service.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/server.ts > OAuth-first codex turn routing with fallback > Added Codex turn execution for normal chat when ChatGPT auth is connected and automatic fallback to OpenAI Responses API-key path when unavailable.
- **2026-02-23** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts > codex auth API and command surfaces > Added Codex-backed auth endpoints and UI controls (`connect/status/rate-limits/disconnect`) plus `/auth limits` command support.
- **2026-02-23** > tests/unit/codex_auth_service.test.ts, tests/unit/codex_chat_service.test.ts, tests/unit/hybrid_llm_service.test.ts, tests/unit/config.test.ts, tests/unit/command_parser.test.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/web_console_ui.test.ts > codex auth/runtime tests > Added unit coverage for account status mapping, login/start shape handling, turn completion text extraction, hybrid fallback routing, and route/UI command wiring.
- **2026-02-23** > scripts/test-manual-checklist, docs/features.md, docs/detailed_project_plan.md, docs/progress.md > responses testing and phase tracking docs > Added manual checklist steps for verifying model responses via OAuth/API key and updated Phase 6 planning/progress docs to reflect OpenAI Responses runtime integration.
- **2026-02-23** > apps/gateway-orchestrator/src/llm/openai_responses_service.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/server.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/auth/oauth_service.ts > OpenAIResponsesService and chat turn routing > Added OpenAI Responses runtime integration for normal chat turns with per-session OAuth token preference, API key fallback, and safe `ack` fallback when no credential is configured.
- **2026-02-23** > tests/unit/openai_responses_service.test.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/oauth_service.test.ts, tests/unit/config.test.ts > responses and credential tests > Added unit coverage for OAuth/API key credential selection, response extraction, gateway LLM routing behavior, OAuth token retrieval, and new config defaults.
- **2026-02-23** > apps/gateway-orchestrator/src/builtins/conversation_store.ts > ConversationStore > Added file-backed conversation event store scaffold for per-session chat history persistence groundwork (refresh-safe transcript replay).
- **2026-02-23** > apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts, apps/worker/src/server.ts, .env.example, scripts/test-manual-checklist > loadDotEnvFile and runtime startup env bootstrap > Added `.env` file loading for gateway/worker startup, introduced committed `.env.example` template, and documented `.env`-first manual test startup.
- **2026-02-23** > apps/gateway-orchestrator/src/auth/oauth_codec.ts, apps/gateway-orchestrator/src/auth/oauth_store.ts, apps/gateway-orchestrator/src/auth/oauth_service.ts > OAuthSecretCodec/OAuthStore/OAuthService > Added OAuth state+token persistence with optional encryption, mock/live modes, callback completion, status, and disconnect flows.
- **2026-02-23** > apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts > loadConfig and runtime wiring > Added OAuth/public URL configuration and gateway startup wiring for OAuth service initialization.
- **2026-02-23** > apps/gateway-orchestrator/src/builtins/command_parser.ts, apps/gateway-orchestrator/src/gateway_service.ts > auth commands and execution paths > Added `/auth connect`, `/auth status`, `/auth disconnect` command support for WhatsApp/chat ingress.
- **2026-02-23** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/ui/render_web_console.ts > OAuth API and UI controls > Added OAuth endpoints (`start/status/disconnect/callback/mock authorize`) and web console controls for local OAuth testing.
- **2026-02-23** > tests/unit/oauth_service.test.ts, tests/integration/oauth_commands.test.ts, tests/unit/command_parser.test.ts, tests/unit/config.test.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/web_console_ui.test.ts > OAuth test coverage > Added unit/integration coverage for OAuth service behavior, command flow, route registration, config parsing, and UI endpoint wiring.
- **2026-02-23** > docs/detailed_project_plan.md, docs/features.md, docs/progress.md, scripts/test-manual-checklist > Phase 6.1 OAuth planning/progress/manual checks > Documented OAuth scope and acceptance criteria, moved Phase 6 to in-progress, and added manual OAuth verification steps.
- **2026-02-23** > apps/gateway-orchestrator/src/ui/render_web_console.ts > renderWebConsoleHtml > Added browser-based test console UI for chat, async jobs, Baileys simulation, and memory operations.
- **2026-02-23** > apps/gateway-orchestrator/src/app.ts, tests/unit/gateway_app_ui_route.test.ts, tests/unit/web_console_ui.test.ts > createGatewayApp and UI route tests > Added `/ui` HTML route, root redirect to `/ui`, and route/render tests for the new interface.
- **2026-02-23** > scripts/test-manual-checklist > web console checklist section > Added manual browser-driven validation steps for the new test interface.
- **2026-02-23** > docs/detailed_project_plan.md, docs/features.md > test surfaces and feature definition > Documented dual testing surfaces (web console now, WhatsApp path next) and acceptance criteria.
- **2026-02-22** > scripts/committer > first-commit index reset path > Added unborn-HEAD-safe staged index clearing so initial commits can run via `scripts/committer`.
- **2026-02-22** > docs/git_workflow.md > workflow sections > Added repository branching, commit, push, and validation workflow documentation.
- **2026-02-22** > docs/changelog.md > changelog format > Created changelog file with required per-change entry format.
- **2026-02-22** > AGENTS.md > Testing Workflow section > Added phase-based automated/manual testing rules and commit-time validation expectations.
- **2026-02-22** > Gemini.md > Testing Workflow section > Added phase-based automated/manual testing rules and commit-time validation expectations.
- **2026-02-22** > docs/detailed_project_plan.md > phase plan and test roadmap > Added phased implementation plan, proposed repo structure, and automated/manual test strategy.
- **2026-02-22** > docs/features.md > MVP and post-MVP features > Added key feature set with acceptance criteria and test approach per feature.
- **2026-02-22** > docs/changelog.md > changelog entries > Corrected legacy entry format and logged new planning/documentation updates.
- **2026-02-22** > AGENTS.md, Gemini.md > Repo Guidelines updates > Reloaded and committed updated agent instruction files with clarified architect/clarification-first guidance.
- **2026-03-01** > apps/worker/src/execution/processor.ts, tests/unit/worker_execution_modules.test.ts > classifyAgenticObjective, classifyAgenticObjectiveHeuristic, parseAgenticObjective, finalizePagedTextResponse > Added unified `agentic_turn` objective routing so worker can choose research vs local-ops handoff vs direct-answer modes (instead of always forcing web-search synthesis), with new unit coverage for direct-answer and local-ops paths.
- **2026-03-01** > apps/gateway-orchestrator/src/builtins/command_parser.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/orchestrator/tool_policy_engine.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts > parseCommand, resolvePathWithinAllowedRoots, executeFileRead, executeFileEdit, evaluateToolPolicy > Added `file.read` and `file.edit` tool surfaces with allowlisted directory policy controls, hash-guarded edit execution, approval integration for edits, and `/file read` + `/file edit` command routing.
- **2026-03-01** > tests/unit/command_parser.test.ts, tests/unit/gateway_service_llm.test.ts, tests/unit/tool_policy_engine.test.ts, tests/unit/config.test.ts, tests/unit/orchestrator_phases.test.ts > parser/policy/config/gateway coverage > Added regression tests for file-read/edit parsing, hash-guarded edits, new tool-policy decisions, config/env parsing, and orchestration policy snapshot compatibility.
- **2026-03-01** > apps/gateway-orchestrator/src/gateway_service.ts, tests/unit/gateway_service_llm.test.ts > resolveShellCwd, isPathInsideRoot, canonicalizePathForScope, stripInvisiblePathChars > Fixed shell scope false-negatives by canonicalizing symlink/invisible-character paths before allowlist checks and added regression coverage for symlink-root local-ops cwd resolution.
- **2026-02-22** > docs/detailed_project_plan.md > architecture and phase definitions > Replaced draft plan with locked decisions, phase exit criteria, and completion rule for progress/changelog updates.
- **2026-02-22** > docs/features.md > MVP and deferred scope > Aligned features to locked runtime, memory, external skill integration, and security model.
- **2026-02-22** > docs/progress.md > phase tracker > Added canonical progress tracking file with current phase and completion checklist template.
- **2026-02-22** > AGENTS.md > Progress and Changelog Discipline section > Added rule to require progress + changelog updates when tasks/phases complete.
- **2026-02-22** > Gemini.md > Progress and Changelog Discipline section > Added rule to require progress + changelog updates when tasks/phases complete.
- **2026-02-22** > package.json, tsconfig.json, vitest.config.ts, .gitignore > project bootstrap scripts/config > Added TypeScript runtime/test tooling with build and phase test commands.
- **2026-02-22** > apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/local_queue_store.ts, apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts > core runtime skeleton > Added config loader, file-backed queue store, gateway service, API app, and gateway startup entrypoint.
- **2026-02-22** > apps/worker/src/worker.ts, apps/worker/src/server.ts > worker loop > Added polling worker with deterministic stub processor, cancellation handling, and process bootstrap.
- **2026-02-22** > packages/contracts/src/job.ts, packages/contracts/src/receipt.ts, packages/contracts/src/index.ts > contracts schemas > Added initial job/message/receipt schemas and exported contract types.
- **2026-02-22** > tests/unit/config.test.ts, tests/unit/schemas.test.ts, tests/integration/job_handoff.test.ts, tests/smoke/phase1_smoke.test.ts, tests/helpers/wait_for.ts > Phase 1 tests > Added unit/integration/smoke tests covering config, contracts, and queue handoff flow.
- **2026-02-22** > scripts/test-unit, scripts/test-integration, scripts/test-smoke, scripts/test-security, scripts/test-manual-checklist > test runners > Added executable scripts for automated and manual phase validation.
- **2026-02-22** > docs/progress.md > Phase 1 status > Marked Phase 1 complete and advanced current phase marker to Phase 2.
- **2026-02-22** > packages/contracts/src/whatsapp.ts, packages/contracts/src/index.ts > WhatsApp contract schema > Added Baileys inbound payload schema export for provider normalization and validation.
- **2026-02-22** > packages/provider-adapters/src/whatsapp_adapter.ts, packages/provider-adapters/src/baileys_adapter.ts, packages/provider-adapters/src/index.ts > provider adapters > Added outbound adapter interface, stdout/in-memory adapters, and Baileys transport adapter wrapper.
- **2026-02-22** > apps/gateway-orchestrator/src/whatsapp/normalize_baileys.ts, apps/gateway-orchestrator/src/whatsapp/dedupe_store.ts > ingress normalization and dedupe > Added Baileys message normalization and file-backed dedupe TTL store.
- **2026-02-22** > apps/gateway-orchestrator/src/notification_store.ts, apps/gateway-orchestrator/src/notification_dispatcher.ts > async status outbox > Added file-backed outbound notification queue and dispatcher loop for WhatsApp status updates.
- **2026-02-22** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts > Phase 2 gateway updates > Added Baileys inbound route handling, dedupe integration, queued notifications, and dispatcher startup wiring.
- **2026-02-22** > apps/worker/src/worker.ts, apps/worker/src/server.ts > worker status events > Added lifecycle status callbacks and notification enqueue integration for running/succeeded/failed/cancelled updates.
- **2026-02-22** > tests/unit/baileys_normalizer.test.ts, tests/unit/dedupe_store.test.ts, tests/integration/baileys_async_updates.test.ts, tests/smoke/phase2_smoke.test.ts > Phase 2 tests > Added unit/integration/smoke coverage for Baileys normalization, dedupe, async updates, and chat responsiveness during long jobs.
- **2026-02-22** > docs/progress.md > Phase 2 status > Marked Phase 2 complete and advanced current phase marker to Phase 3 in progress.
- **2026-02-22** > packages/memory/src/types.ts, packages/memory/src/redact.ts, packages/memory/src/chunker.ts, packages/memory/src/embeddings.ts, packages/memory/src/sqlite_memory_index.ts, packages/memory/src/memory_service.ts, packages/memory/src/index.ts > memory subsystem > Added markdown-canonical memory service with SQLite FTS index, embedding cache, hybrid search, snippet retrieval, note append, sync triggers, and status reporting APIs.
- **2026-02-22** > apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts > memory API wiring > Added memory endpoints (`status`, `sync`, `search`, `snippet`, `notes`) and runtime memory service startup/shutdown wiring in gateway process.
- **2026-02-22** > tests/unit/memory_chunker.test.ts, tests/unit/memory_redact.test.ts, tests/integration/memory_service.test.ts, tests/smoke/phase3_smoke.test.ts > Phase 3 tests > Added unit/integration/smoke coverage for chunking, redaction, cited retrieval, append flow, and recall quality baseline.
- **2026-02-22** > scripts/test-manual-checklist > manual validation guide > Expanded manual checklist with Phase 2 and Phase 3 verification steps and commands.
- **2026-02-22** > docs/progress.md > Phase 3 status > Marked Phase 3 complete and advanced current phase marker to Phase 4 not started.
- **2026-02-22** > packages/contracts/src/skill.ts, packages/contracts/src/index.ts > skill contract schema > Added skill manifest and structured error schemas for external skill packaging and invocation validation.
- **2026-02-22** > packages/skill-runner/src/types.ts, packages/skill-runner/src/security.ts, packages/skill-runner/src/registry.ts, packages/skill-runner/src/installer.ts, packages/skill-runner/src/runner.ts, packages/skill-runner/src/index.ts > external skill integration subsystem > Added allowlisted git installer pinned to commit SHA, file-backed skill registry, CLI runner contract, workspace scope checks, and manifest security validation.
- **2026-02-22** > tests/helpers/skill_repo.ts, tests/unit/skill_manifest.test.ts, tests/unit/skill_security.test.ts, tests/integration/skill_install_and_run.test.ts, tests/security/skill_policy.test.ts > Phase 4 tests > Added fixture helper plus unit/integration/security coverage for manifest validation, allowlist enforcement, install flow, invocation flow, and policy guardrails.
- **2026-02-22** > package.json, scripts/test-security, scripts/test-manual-checklist > test command and manual validation updates > Added dedicated security test command wiring and expanded checklist with Phase 4 verification steps.
- **2026-02-22** > docs/progress.md > Phase 4 status > Marked Phase 4 complete and advanced current phase marker to Phase 5 not started.
- **2026-02-22** > apps/gateway-orchestrator/src/builtins/reminder_store.ts, apps/gateway-orchestrator/src/builtins/task_store.ts, apps/gateway-orchestrator/src/builtins/approval_store.ts, apps/gateway-orchestrator/src/builtins/reminder_dispatcher.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts > built-in workflow stores and command parsing > Added file-backed reminders/tasks/approvals, reminder scheduler, and command parser for chat-driven controls.
- **2026-02-22** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/config.ts, apps/gateway-orchestrator/src/server.ts > Phase 5 service wiring > Added built-in command handling, side-effect approval gate flow, reminder/task orchestration, retry endpoint support, and runtime dispatcher wiring.
- **2026-02-22** > apps/gateway-orchestrator/src/local_queue_store.ts, packages/contracts/src/job.ts > retry contract > Added retry job creation flow and `retryOf` linkage in job schema for failed/cancelled reruns.
- **2026-02-22** > tests/unit/command_parser.test.ts, tests/integration/reminders_and_commands.test.ts, tests/smoke/phase5_smoke.test.ts > Phase 5 tests > Added unit/integration/smoke coverage for command parsing, reminders, tasks, approvals, and job retry control.
- **2026-02-22** > scripts/test-manual-checklist > manual validation guide > Added explicit Phase 5 command-based manual verification steps.
- **2026-02-22** > docs/progress.md > Phase 5 status > Marked Phase 5 complete and advanced current phase marker to Phase 6 not started.
- **2026-02-22** > apps/gateway-orchestrator/src/builtins/note_store.ts, apps/gateway-orchestrator/src/builtins/command_parser.ts > notes capability > Added file-backed notes store and `/note add`/`/note list` command parsing.
- **2026-02-22** > apps/gateway-orchestrator/src/gateway_service.ts, apps/gateway-orchestrator/src/app.ts, apps/gateway-orchestrator/src/server.ts > notes runtime wiring > Added note command handling and note store wiring in gateway/app/server composition.
- **2026-02-22** > tests/unit/command_parser.test.ts, tests/unit/note_store.test.ts, tests/integration/reminders_and_commands.test.ts, tests/smoke/phase5_smoke.test.ts > notes test coverage > Added/expanded unit, integration, and smoke tests for note command flows.
- **2026-02-22** > scripts/test-manual-checklist, docs/progress.md > phase 5 docs refinement > Added manual note-validation steps and updated Phase 5 summary to explicitly include notes.
